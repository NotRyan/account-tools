Work in progress. This version currently does not work. Having issues with interactings with modal dialogs. 
